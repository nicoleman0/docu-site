
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Open-source security policies and cybersecurity documentation">
      
      
        <meta name="author" content="Nicholas Coleman">
      
      
        <link rel="canonical" href="https://nicoleman0.github.io/docu-site/tools/port-scanner-go/">
      
      
        <link rel="prev" href="../vtscan/">
      
      
        <link rel="next" href="../../blog/wazuh-setup/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Port Scanner in Go - Corvus Library</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#building-a-port-scanner-in-go" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Corvus Library" class="md-header__button md-logo" aria-label="Corvus Library" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Corvus Library
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Port Scanner in Go
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/nicoleman0/docu-site" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Corvus Library" class="md-nav__button md-logo" aria-label="Corvus Library" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Corvus Library
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nicoleman0/docu-site" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Policies
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Policies
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/aup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Acceptable-Use Policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dnspy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNSpy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vtscan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VTScan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Port Scanner in Go
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Port Scanner in Go
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-build-a-port-scanner" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Build a Port Scanner?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Project Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-core-scanner-logic-internalscanner" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Core Scanner Logic (internal/scanner/)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-service-detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Service Detection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-output-formatting-internaloutput" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Output Formatting (internal/output/)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Features
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flexible-port-selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Flexible Port Selection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-target-support" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiple Target Support
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Performance Tuning
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Usage Examples
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-highlights" class="md-nav__link">
    <span class="md-ellipsis">
      
        Technical Highlights
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Technical Highlights">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concurrency-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      
        Concurrency Pattern
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#banner-sanitization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Banner Sanitization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-color-detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automatic Color Detection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lessons-learned" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lessons Learned
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lessons Learned">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-concurrency-trade-offs" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Concurrency Trade-offs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-timeout-sensitivity" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Timeout Sensitivity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-clean-abstractions" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Clean Abstractions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Future Enhancements
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conclusion
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/wazuh-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setting Up Wazuh
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    References
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-build-a-port-scanner" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Build a Port Scanner?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Project Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-core-scanner-logic-internalscanner" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Core Scanner Logic (internal/scanner/)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-service-detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Service Detection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-output-formatting-internaloutput" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Output Formatting (internal/output/)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Features
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flexible-port-selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Flexible Port Selection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-target-support" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiple Target Support
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Performance Tuning
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Usage Examples
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-highlights" class="md-nav__link">
    <span class="md-ellipsis">
      
        Technical Highlights
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Technical Highlights">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concurrency-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      
        Concurrency Pattern
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#banner-sanitization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Banner Sanitization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-color-detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automatic Color Detection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lessons-learned" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lessons Learned
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lessons Learned">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-concurrency-trade-offs" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Concurrency Trade-offs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-timeout-sensitivity" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Timeout Sensitivity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-clean-abstractions" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Clean Abstractions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Future Enhancements
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conclusion
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="building-a-port-scanner-in-go">Building a Port Scanner in Go<a class="headerlink" href="#building-a-port-scanner-in-go" title="Permanent link">&para;</a></h1>
<p>As a security enthusiast, I've found that understanding network reconnaissance is foundational. To deepen my knowledge of both Go and network security, I built <strong>portscanner-go</strong>: a lightweight, concurrent TCP port scanner designed for speed and simplicity.</p>
<hr />
<h2 id="why-build-a-port-scanner">Why Build a Port Scanner?<a class="headerlink" href="#why-build-a-port-scanner" title="Permanent link">&para;</a></h2>
<p>Port scanners are essential tools in penetration testing and security auditing. They help identify which services are running on a target system, providing the first step in vulnerability assessment. While tools like Nmap are industry standards, building my own scanner helped me understand:</p>
<ul>
<li>TCP connection mechanisms and network timeouts</li>
<li>Concurrent programming patterns in Go</li>
<li>Service fingerprinting techniques</li>
<li>Practical network security concepts</li>
</ul>
<hr />
<h2 id="project-architecture">Project Architecture<a class="headerlink" href="#project-architecture" title="Permanent link">&para;</a></h2>
<p>The scanner is organized into three main components:</p>
<h3 id="1-core-scanner-logic-internalscanner">1. <strong>Core Scanner Logic</strong> (<code>internal/scanner/</code>)<a class="headerlink" href="#1-core-scanner-logic-internalscanner" title="Permanent link">&para;</a></h3>
<p>The heart of the application uses a worker pool pattern to perform concurrent TCP connect scans:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">ScanHostPorts</span><span class="p">(</span><span class="nx">host</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">ports</span><span class="w"> </span><span class="p">[]</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="nx">timeout</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="p">,</span><span class="w"> </span><span class="nx">workers</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="nx">probe</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">[]</span><span class="nx">Result</span>
</code></pre></div>

<p>Key features:
- <strong>Worker Pool</strong>: Configurable number of goroutines (default: 500) to balance speed and resource usage
- <strong>TCP Connect Scan</strong>: Uses standard <code>net.DialTimeout()</code> - no raw sockets or root privileges required
- <strong>Latency Tracking</strong>: Measures connection time to identify fast vs. slow responses
- <strong>Service Fingerprinting</strong>: Optional probing to identify services beyond just port numbers</p>
<h3 id="2-service-detection">2. <strong>Service Detection</strong><a class="headerlink" href="#2-service-detection" title="Permanent link">&para;</a></h3>
<p>When the <code>-service</code> flag is enabled, the scanner attempts to identify running services through multiple techniques:</p>
<p><strong>Banner Grabbing</strong>: Reads initial data sent by the service (SSH, SMTP, FTP, etc.)</p>
<div class="codehilite"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">fingerprintService</span><span class="p">(</span><span class="nx">host</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="nx">conn</span><span class="w"> </span><span class="nx">net</span><span class="p">.</span><span class="nx">Conn</span><span class="p">,</span><span class="w"> </span><span class="nx">timeout</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span>
</code></pre></div>

<p><strong>HTTP Probing</strong>: Sends HTTP requests to common web ports to detect web servers and extract Server headers</p>
<p><strong>TLS Handshake</strong>: Performs TLS negotiation on HTTPS ports to extract certificate information (CN, issuer, ALPN)</p>
<p>The scanner recognizes common protocols including SSH, HTTP/HTTPS, SMTP, FTP, POP3, IMAP, and many others.</p>
<h3 id="3-output-formatting-internaloutput">3. <strong>Output Formatting</strong> (<code>internal/output/</code>)<a class="headerlink" href="#3-output-formatting-internaloutput" title="Permanent link">&para;</a></h3>
<p>Results are displayed in a clean, colorized table format when outputting to a terminal:</p>
<ul>
<li><strong>Color-coded states</strong>: Green for open ports, red for closed</li>
<li><strong>Latency indicators</strong>: Green (&lt;5ms), yellow (&lt;50ms), red (&gt;50ms)</li>
<li><strong>Service information</strong>: Shows detected service names, banners, and fingerprints</li>
<li><strong>JSON support</strong>: Optional <code>-json</code> flag for programmatic consumption</li>
</ul>
<hr />
<h2 id="key-features">Key Features<a class="headerlink" href="#key-features" title="Permanent link">&para;</a></h2>
<h3 id="flexible-port-selection">Flexible Port Selection<a class="headerlink" href="#flexible-port-selection" title="Permanent link">&para;</a></h3>
<p>The scanner supports multiple ways to specify ports:</p>
<ul>
<li><code>top:N</code> - Scan the N most common ports (default: top:1000)</li>
<li>Ranges: <code>1-1024</code></li>
<li>Specific ports: <code>80,443,8080</code></li>
<li>Combinations: <code>1-1024,8080,8443</code></li>
</ul>
<h3 id="multiple-target-support">Multiple Target Support<a class="headerlink" href="#multiple-target-support" title="Permanent link">&para;</a></h3>
<p>Specify targets as:
- Single hosts: <code>192.168.1.1</code>
- Comma-separated: <code>192.168.1.1,192.168.1.2</code>
- CIDR notation: <code>192.168.1.0/24</code> (IPv4 only)</p>
<h3 id="performance-tuning">Performance Tuning<a class="headerlink" href="#performance-tuning" title="Permanent link">&para;</a></h3>
<ul>
<li><code>-workers</code>: Adjust concurrency level (default: 500)</li>
<li><code>-timeout</code>: Set connection timeout per port (default: 500ms)</li>
<li>Balance between speed and accuracy based on network conditions</li>
</ul>
<hr />
<h2 id="usage-examples">Usage Examples<a class="headerlink" href="#usage-examples" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="c1"># Quick scan of top 100 ports on localhost</span>
./portscan<span class="w"> </span>-hosts<span class="w"> </span><span class="m">127</span>.0.0.1

<span class="c1"># Scan specific ports with service detection</span>
./portscan<span class="w"> </span>-hosts<span class="w"> </span><span class="m">192</span>.168.1.10<span class="w"> </span>-ports<span class="w"> </span><span class="m">1</span>-1024,8080,8443<span class="w"> </span>-service

<span class="c1"># Scan entire subnet with JSON output</span>
./portscan<span class="w"> </span>-hosts<span class="w"> </span><span class="s2">&quot;192.168.1.0/24&quot;</span><span class="w"> </span>-ports<span class="w"> </span>top:200<span class="w"> </span>-json<span class="w"> </span>-o<span class="w"> </span>results.json

<span class="c1"># Include closed ports in results</span>
./portscan<span class="w"> </span>-hosts<span class="w"> </span>example.com<span class="w"> </span>-ports<span class="w"> </span>top:100<span class="w"> </span>-all

<span class="c1"># High-speed scan with aggressive settings</span>
./portscan<span class="w"> </span>-hosts<span class="w"> </span><span class="m">10</span>.0.0.5<span class="w"> </span>-ports<span class="w"> </span>top:1000<span class="w"> </span>-workers<span class="w"> </span><span class="m">800</span><span class="w"> </span>-timeout<span class="w"> </span>300ms
</code></pre></div>

<hr />
<h2 id="technical-highlights">Technical Highlights<a class="headerlink" href="#technical-highlights" title="Permanent link">&para;</a></h2>
<h3 id="concurrency-pattern">Concurrency Pattern<a class="headerlink" href="#concurrency-pattern" title="Permanent link">&para;</a></h3>
<p>The scanner implements a classic producer-consumer pattern with goroutines:
- A producer goroutine feeds port numbers into a jobs channel
- Worker goroutines consume from the jobs channel and write results
- A WaitGroup ensures all workers complete before results are collected</p>
<h3 id="banner-sanitization">Banner Sanitization<a class="headerlink" href="#banner-sanitization" title="Permanent link">&para;</a></h3>
<p>To handle unprintable characters in service banners:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">sanitizeBanner</span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span>
</code></pre></div>

<p>This function filters non-printable ASCII characters and normalizes whitespace, ensuring clean output.</p>
<h3 id="automatic-color-detection">Automatic Color Detection<a class="headerlink" href="#automatic-color-detection" title="Permanent link">&para;</a></h3>
<p>The output formatter detects if stdout is a TTY and automatically enables/disables ANSI color codes:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">isTTY</span><span class="p">(</span><span class="nx">w</span><span class="w"> </span><span class="nx">io</span><span class="p">.</span><span class="nx">Writer</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span>
</code></pre></div>

<p>This ensures clean output whether printing to a terminal or redirecting to a file.</p>
<hr />
<h2 id="lessons-learned">Lessons Learned<a class="headerlink" href="#lessons-learned" title="Permanent link">&para;</a></h2>
<h3 id="1-concurrency-trade-offs">1. <strong>Concurrency Trade-offs</strong><a class="headerlink" href="#1-concurrency-trade-offs" title="Permanent link">&para;</a></h3>
<p>Finding the right worker pool size is crucial. Too few workers and scans are slow; too many can overwhelm networks or trigger rate limiting. The default of 500 workers with 500ms timeout works well for most networks.</p>
<h3 id="2-timeout-sensitivity">2. <strong>Timeout Sensitivity</strong><a class="headerlink" href="#2-timeout-sensitivity" title="Permanent link">&para;</a></h3>
<p>Different services respond at different speeds. HTTPS handshakes require more time than simple TCP connections. The scanner uses fractional timeouts for multi-step probing (e.g., TLS then HTTP).</p>
<h3 id="3-clean-abstractions">3. <strong>Clean Abstractions</strong><a class="headerlink" href="#3-clean-abstractions" title="Permanent link">&para;</a></h3>
<p>Organizing code into <code>internal/scanner</code>, <code>internal/output</code>, and <code>internal/ports</code> packages kept the codebase maintainable and testable. Each package has a single, clear responsibility.</p>
<hr />
<h2 id="future-enhancements">Future Enhancements<a class="headerlink" href="#future-enhancements" title="Permanent link">&para;</a></h2>
<p>Some ideas for future development:
- UDP port scanning support
- SYN scanning with raw sockets (requires privileges)
- Nmap-style OS fingerprinting
- Plugin system for custom service detection
- Progress indicators for long scans
- Rate limiting controls</p>
<hr />
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>Building this port scanner was an excellent learning experience that reinforced my understanding of networking fundamentals, Golang, and practical security reconnaissance techniques. The project demonstrates how relatively simple code can create a powerful, useful, and fast security tool.</p>
<p>The complete source code is available on <a href="https://github.com/nicoleman0/portscanner-go">GitHub</a>.</p>
<p>Whether you're learning Go, exploring network security, or just need a lightweight port scanner, I hope this project proves useful or educational.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.sections", "navigation.top", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>